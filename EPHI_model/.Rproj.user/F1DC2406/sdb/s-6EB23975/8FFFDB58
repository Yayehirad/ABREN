{
    "collab_server" : "",
    "contents" : "#Numeric simulation\n#load packages\nlibrary(deSolve)\n\n#define function\nModel_fun<-function(time, state, parameters)\n{\n  with(as.list(c(state, parameters)), {\n  #creat state variables (local variables)\n  #S<-state[1] # Susceptible \n  #E_u<-state[2] #Non-quarantined Exposed\n  #E_q<-state[3] #Quarantined Exposed\n  #I_u<-state[4] # Quarantined infectious\n  #I_h<-state[5] # Isolated/hospitalised infectious\n  #I_icu<-state[6] # ICU infectious\n  #I_a<-state[7] # Asymptomatic infectious\n  #R<-state[8] # Recovered \n  #D<-state[9]# Dead\n  \n  #with(\n #   as.list(parameters), #variable names within parameters can be used\n  #  {\n      #compute derivative\n      \n      \n #lambda=(beta*(1-E_M*C_M)*(I_u+eta_a*I_a+eta_h*I_h)/(N-theta_q*(E_q+I_h+I_icu)))\n      \n     dS = - (beta* S_D* (1-E_M*C_M) * (I_u+eta_a*I_a+eta_h*I_h+eta_icu*I_icu)/N)*S\n      \n      \n      \n      dE_u = (beta*S_D*(1-E_M*C_M)*(I_u+eta_a*I_a+eta_h*I_h+eta_icu*I_icu)/N)*S - \n        (sigma_u+alpha_u)*E_u\n\n      \n      dE_q = alpha_u*E_u - \n        sigma_q*E_q\n     \n      \n      dI_u = f*sigma_u*E_u - \n        (gamma_u+phi_u+delta_u)*I_u\n      \n    \n      dI_h = sigma_q*E_q+phi_u*I_u+sigma_a*I_a -\n        (gamma_h+nu_h+delta_h)*I_h\n      \n      dI_a = (1-f)*sigma_u*E_u + sigma_q*E_q - \n        (gamma_a+sigma_a+delta_a)*I_a\n      \n     \n      dI_icu = nu_h*I_h - \n        (gamma_icu + delta_icu)*I_icu\n      \n      \n      dR = gamma_u*I_u+ gamma_h*I_h + gamma_a*I_a + gamma_icu*I_icu\n      \n      dD = delta_u*I_u + delta_h*I_h + delta_a*I_a + delta_icu*I_icu\n      \n      \n      #combine results\n      results=c(dS,dE_u, dE_q,dI_u,dI_h,dI_a,dI_icu,dR,dD)\n      list(results)\n    }\n  )\n}\n#Parameter values\nR0=2.5\nduration_infectiousness=10\n#force of infection\neffective_contact_rate_per_infectious_per_time= R0/duration_infectiousness #\nmask_efficacy = 0.5\nrelative_infectiousness_of_I_a_compared_to_I_u=0.5\nrelative_infectiousness_of_I_h_compared_to_I_u=0.2\nrelative_infectiousness_of_I_icu_compared_to_I_u=0.2\n\nbeta = effective_contact_rate_per_infectious_per_time\nE_M = mask_efficacy\neta_a = relative_infectiousness_of_I_a_compared_to_I_u\neta_h = relative_infectiousness_of_I_h_compared_to_I_u\neta_icu = relative_infectiousness_of_I_icu_compared_to_I_u\n  \n#compartment durations\nincubation_period=5 \ninfectious_period=7 \nhospital_stay=10\nicu_period=10 \n\n\n\n# total outflows from compartments\ntotal_outflow_E_u = 1/incubation_period\ntotal_outflow_E_q = 1/incubation_period\ntotal_outflow_I_u = 1/infectious_period\ntotal_outflow_I_a = 1/infectious_period\ntotal_outflow_I_h = 1/hospital_stay\ntotal_outflow_I_icu = 1/icu_period\n\n \n\nproportion_of_E_u_progressing_to_I_u=0.4\nf=proportion_of_E_u_progressing_to_I_u\n#proportions of Covid related death\nproportion_mortality_in_I_u= 0.02\nproportion_mortality_in_I_a= 0.02\nproportion_mortality_in_I_h= 0.02\nproportion_mortality_in_I_icu= 0.02\n#ICU\nproportion_I_h_requiring_ICU=0.1\nnu_h = proportion_I_h_requiring_ICU*total_outflow_I_h\n#intervention \nproportion_population_wearing_faceMask=0.5\nproportion_nonquaratined_Exposed__isolated_by_contact_tracing=0.1\nproportion_Asymptomatic_infectious_isolated_by_contact_tracing=0.2\nproportion_Nonquarantined_infectious_isolated_by_detection=0.7\nreduction_in_contact_rate_by_social_distancing = 1-0.25 \n\nalpha_u  = proportion_nonquaratined_Exposed__isolated_by_contact_tracing * total_outflow_E_u\nphi_u    = proportion_Nonquarantined_infectious_isolated_by_detection * total_outflow_I_u\nsigma_a  = proportion_Asymptomatic_infectious_isolated_by_contact_tracing * total_outflow_I_a\nC_M      = proportion_population_wearing_faceMask\nS_D      = reduction_in_contact_rate_by_social_distancing\n\n\n\n#progression rates from Exposed to Infectious\nsigma_u = total_outflow_E_u - alpha_u\nsigma_q = total_outflow_E_q\n\n##Mortality rates\ndelta_u =  proportion_mortality_in_I_u*total_outflow_I_u\ndelta_a = proportion_mortality_in_I_a*total_outflow_I_a\ndelta_h = proportion_mortality_in_I_h*total_outflow_I_h\ndelta_icu = proportion_mortality_in_I_icu*total_outflow_I_icu\n\n\n\n\n#Recovery rate\n\ngamma_u = total_outflow_I_u-(delta_u + phi_u)\n\ngamma_a = total_outflow_I_a-(delta_a + sigma_a)\n\ngamma_h = total_outflow_I_h - (delta_h + nu_h)\n\ngamma_icu = total_outflow_I_icu - delta_icu \n\n\nparameter_list<- c(beta=beta,E_M=E_M,C_M=C_M,\n                   eta_h=eta_h,eta_a=eta_a,eta_icu=eta_icu,\n                   sigma_u=sigma_u,sigma_a=sigma_a,sigma_q=sigma_q,\n                   alpha_u=alpha_u, phi_u=phi_u, f=f,\n                   delta_u=delta_u,delta_h=delta_h,delta_a=delta_a,delta_icu=delta_icu,\n                   gamma_u=gamma_u,gamma_h=gamma_h,gamma_a=gamma_a,gamma_icu=gamma_icu,\n                   nu_h=nu_h)\n#compartment population \nN=100000000\n\nE_u0= 0\nE_q0=0\nI_u0=500\nI_a0=500\nI_h0=0\nI_icu0=0\nR0=0\nD0=0\nS0=N-(E_u0+E_q0+I_u0+I_a0+I_h0+I_icu0+R0+D0)\n\ninitial_populations <- c(S=S0,E_u=E_u0,E_q=E_q0,\n                         I_u=I_u0,I_a=I_a0,I_h=I_h0,I_icu=I_icu0,\n                         R=R0,D=D0)\ntime=seq(0, 2000, by = 1)\n\noutput_baseline=as.data.frame(lsoda(initial_populations, time, Model_fun, parameter_list))\nView(output_baseline)\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1591096864371.000,
    "dirty" : false,
    "encoding" : "WINDOWS-1252",
    "folds" : "",
    "hash" : "3399340532",
    "id" : "8FFFDB58",
    "lastKnownWriteTime" : 1591167252,
    "last_content_update" : 1591167252126,
    "path" : "~/R-course/COVID19/Model from EPHI/EPHI_model/Intervention.r",
    "project_path" : "Intervention.r",
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}