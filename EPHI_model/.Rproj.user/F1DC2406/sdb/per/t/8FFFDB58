{
    "collab_server" : "",
    "contents" : "#Numeric simulation\n#Step 1 load packages\nlibrary(deSolve)\n\n#define function\nModel_fun<- function(time, state, parameters) {\n  \n  \n  #creat state variables (local variables)\n  S<-state[1] # Susceptible \n  E<-state[2] # Exposed\n  I_u<-state[3] # non-isolated infectious\n  I_h<-state[4] # Isolated/hospitalised infectious\n  R<-state[5] # Recovered \n  D<-state[6]# Dead\n  \n  with(\n   as.list(parameters), #variable names within parameters can be used\n   {\n      #compute derivative\n    \n    dS <- - beta* S_D*(1-E_M*C_M)*((I_u+ eta_h*I_h)/N)*S\n      \n    dE <- beta*S_D*(1-E_M*C_M)*((I_u+eta_h*I_h)/N)*S - sigma*E\n\n    dI_u <- (1-f)*sigma*E - p1*phi_u*I_u + p2*delta_u*I_u + (1-(p1+p2))*gamma_u*I_u\n     \n    dI_h <-  f*sigma*E + p1*phi_u*I_u - (1-q)*gamma_h*I_h + q*delta_h*I_h\n     \n    dR <- (1-(p1+p2))*gamma_u*I_u + (1-q)*gamma_h*I_h \n      \n    dD <- p2*delta_u*I_u + q*delta_h*I_h \n      \n      \n      #combine results\n      results=c(dS,dE,dI_u,dI_h,dR,dD)\n      list(results)\n    }\n  )\n  }\n\n#Parameter values\nR0=2.6\n\n#compartment durations\n\nincubation_period=5 \ninfectious_period=7 \nhospital_stay=10\n\ndetection_delay=5\n\n#force of infection\neffective_contact_rate_per_infectious_per_time= R0/infectious_period #\nmask_efficacy = 0.3\nrelative_infectiousness_of_I_h_compared_to_I_u=0.2\n\n\nbeta = effective_contact_rate_per_infectious_per_time\nE_M = mask_efficacy\neta_h = relative_infectiousness_of_I_h_compared_to_I_u\n\n# total outflows from compartments\nE_outflow = 1/incubation_period\n\nI_u_outflow_recovery_death = 1/infectious_period\n\nI_u_outflow_detection = 1/detection_delay\n\nI_h_outflow = 1/hospital_stay\n\n\n \n#proportions of Covid related death\n\n\nproportion_of_I_u_confirmed_and_isolated=0.4\nproportion_mortality_from_I_u= 0.02\nproportion_mortality_from_I_h= 0.02\n\np2=proportion_mortality_from_I_u\nq=proportion_mortality_from_I_h\n\n#intervention\nproportion_of_E_u_progressing_to_I_h=0.0\nproportion_population_wearing_faceMask=0.0\nreduction_in_contact_rate_by_social_distancing = 1 \nproportion_of_I_u_confirmed_and_isolated=0.0\n\nf=proportion_of_E_u_progressing_to_I_h\nC_M      = proportion_population_wearing_faceMask\nS_D      = reduction_in_contact_rate_by_social_distancing\np1      =proportion_of_I_u_confirmed_and_isolated\nphi_u   = p1*I_u_outflow_detection\n\n\n\n\n#progression rates from Exposed to Infectious\nsigma = E_outflow \n\n##Mortality rates\ndelta_u =  I_u_outflow_recovery_death\n\ndelta_h = I_h_outflow\n\n#Recovery rate\n\ngamma_u = I_u_outflow_recovery_death\n\ngamma_h = I_h_outflow\n\n\n#list parameters\n\nparameters<- c(beta=beta, E_M=E_M, C_M=C_M,\n               p1=p1, p2=p2, q=q, f=f,\n                eta_h=eta_h,\n                sigma=sigma, phi_u=phi_u, \n                   delta_u=delta_u, delta_h=delta_h,\n                   gamma_u=gamma_u, gamma_h=gamma_h)\n#compartment population \nN=4e+06\nE0= N*0.001 #4000\nI_u0=N*0.00025 #1000\nI_h0=N*0#0.00025 #1000\nR0=N*5e-05 #200\nD0=N*2.5e-05#100\nS0= N-(E0+I_u0+I_h0+R0+D0)\n\ninitial_populations <- c(S=S0,E=E0,\n                         I_u=I_u0,I_h=I_h0,\n                         R=R0,D=D0)\ntime=seq(0, 365, by = 1)\n\noutput_baseline=as.data.frame(lsoda(initial_populations, time, Model_fun, parameters))\nView(output_baseline)\n\n#Check total population N=4e+06\noutput_baseline$N_t<- output_baseline$S + output_baseline$E + output_baseline$I_u + output_baseline$I_h + output_baseline$R + output_baseline$D\nView(output_baseline)\nplot(output_baseline$time,output_baseline$N_t,type = 'l')\n\n#PLOT\n#presentation tuesday @ 6pm 10mins \nplot(output_baseline$time,output_baseline$R,\n     #ylim = c(0,4e+06),\n     type=\"n\",\n     xlab='Time in days',\n     ylab = 'Number of cases', main=\"Types of cases\", panel.first= grid())\n\nlines(output_baseline$time,output_baseline$S,lwd=2.5,col='chocolate4')\nlines(output_baseline$time,output_baseline$E,lwd=2.5,col='darkorchid1')\nlines(output_baseline$time,output_baseline$I_u,lwd=3,col=\"blue\")\nlines(output_baseline$time,output_baseline$I_h,lwd=3,col = 'red')\n\nlines(output_baseline$time,output_baseline$R,lwd=2.5,col = 'green')\nlines(output_baseline$time,output_baseline$D,lwd=2.5,col = 'black')\nlegend(0,4e+06,c(\"Susceptible\",\"Exposed\",\n                 \"Non-isolated Infectious\",\n                 \"Isolated Infectious\",\"Recoverd\",\"Dead\"),\n       lty=c(1,1,1,1,1,1),lwd=c(3,3,3,3,3,3),\n       col=c('chocolate4','darkorchid1',\"blue\",\"red\",\"green\",'black'))\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1591096864371.000,
    "dirty" : false,
    "encoding" : "WINDOWS-1252",
    "folds" : "",
    "hash" : "14718703",
    "id" : "8FFFDB58",
    "lastKnownWriteTime" : 1591371151,
    "last_content_update" : 1591371151442,
    "path" : "~/R-course/COVID19/Model from EPHI/ABREN/EPHI_model/Intervention.r",
    "project_path" : "Intervention.r",
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}