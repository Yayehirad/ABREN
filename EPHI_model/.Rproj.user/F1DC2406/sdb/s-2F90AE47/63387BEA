{
    "collab_server" : "",
    "contents" : "#SEII_hRD model for mask coverage \n#Step 1 load packages\nlibrary(deSolve)\n\n#define function\nSEIIRD_fun<- function(current_timepoint, state_values, parameters)\n{\n  \n  #creat state variables (local variables)\n  S<-state_values[1] # Susceptible \n  E<-state_values[2] # Exposed\n  I<-state_values[3] #  Infectious\n  I_h<-state_values[4]\n  R<-state_values[5] # Recovered \n  D<-state_values[6]#Died\n  with(\n    as.list(parameters), #variable names within parameters can be used\n    {\n      #compute derivative\n      \n      dS <- -beta_intervention*S*(I+eta_ih*I_h)/N\n      \n      dE <- beta_intervention*S*(I+ eta_ih*I_h)/N- sigma_i*E - sigma_ih*E\n      \n      dI <- sigma_i*E - gamma_i*I- delta_i*I - phi_i*I\n      \n      dI_h <- sigma_ih*E +phi_i*I - gamma_ih*I_h- delta_ih*I_h\n      \n      dR <- gamma_i*I + gamma_ih*I_h\n      \n      dD<- delta_i*I + delta_ih*I_h\n      \n      \n      \n      #combine results\n      results=c(dS,dE,dI,dI_h, dR,dD)\n      list(results)\n    }\n  )\n}\n\n\n\n\n#compartment durations\n\nincubation_period=5 \ninfectious_period=7 \nisolation_stay= 10\n# total outflows from compartments\nE_outflow = 1/incubation_period\n\nI_outflow_recovery_death = 1/infectious_period\nI_h_outflow=1/isolation_stay\n#force of infection\nR0=2.21\neffective_contact_rate_per_infectious_per_time= R0/infectious_period #\n\n\nbeta = effective_contact_rate_per_infectious_per_time\n\n#Intervention \n##1 Face Mask\nC_M=0.8 #faceMask coverrage c(0,0.25, 0.5, 0.6, 0.7, 0.8)\nE_M=0.3#faceMask efficacy\n##2 Social distancing \nS_D=1 # relative reduction in contact rate by social distancing\n\nbeta_intervention =beta*S_D*(1-C_M*E_M)\n\n## 3 contact tracing and case finding\nproportion_E_isolated=0.0 #contact tracing of exposed group\nproportion_I_isolated=0.0 #Case finding of Infectious group\n\n\nrelative_infectiousness_of_isolated_compared_to_non_isolated_infectiopu=0.2\neta_ih=relative_infectiousness_of_isolated_compared_to_non_isolated_infectiopu\n\nsigma_ih = proportion_E_isolated*E_outflow \nsigma_i= E_outflow - sigma_ih\n#mortality\nproportion_mortality_from_I=0.05\nproportion_mortality_from_I_h=0.02\n\ndelta_i= proportion_mortality_from_I*I_u_outflow_recovery_death\nphi_i= proportion_I_isolated*I_u_outflow_recovery_death\n\ndelta_ih =proportion_mortality_from_I_h*I_h_outflow\n#Recovery rate\n\ngamma_i = I_outflow_recovery_death - delta_i - phi_i\ngamma_ih =I_h_outflow - delta_ih\n\n\n\n\n#list parameters\n\nparameter_list<- c(beta_intervention=beta_intervention, \n                   eta_ih=eta_ih,\n                   sigma_i=sigma_i, \n                   delta_i=delta_i,\n                   gamma_i=gamma_i,\n                   \n                   sigma_ih=sigma_ih,\n                   delta_ih=delta_ih,\n                   gamma_ih=gamma_ih)\n#compartment population \nN=4e+06\nE0= N*0.0 #4000\nI0=N*0.00025 #1000\nI_h0=N*0\nR0=N*0 #200\nD0=0\nS0= N-(E0+I0+I_h0+R0+D0)\n\ninitial_values <- c(S=S0,E=E0,\n                    I=I0,I_h=I_h0,\n                    R=R0, D=D0)\ntimes=seq(0, 365, by = 1)\n\noutput_SEIIRD=as.data.frame(lsoda(initial_values, times, SEIIRD_fun, parameter_list))\n\n\n#Check total population N=4e+06\noutput_SEIIRD$N_t<- output_SEIIRD$S + output_SEIIRD$E + output_SEIIRD$I  +\n  output_SEIIRD$I_h+ output_SEIIRD$R +output_SEIIRD$D \n#View dataframe\n#View(output_SEIIRD)\n#plot population and check it is Constant\nplot(output_SEIIRD$time,output_SEIIRD$N_t,type = 'l')\n\n\n# ONLY Mask\n#0% mask \ndata_mask<- output_SEIIRD[,c(\"time\",\"I\",\"D\")]\n\n#25 % Mask coverage\ndata_mask$I_.25<- output_SEIIRD$I\ndata_mask$D_.25<- output_SEIIRD$D\nView(data_mask)\n\n#50% mask coverage\ndata_mask$I_.5<- output_SEIIRD$I\ndata_mask$D_.5<- output_SEIIRD$D\n#60%\ndata_mask$I_.6<- output_SEIIRD$I\ndata_mask$D_.6<- output_SEIIRD$D\n\n#70%\ndata_mask$I_.7<- output_SEIIRD$I\ndata_mask$D_.7<- output_SEIIRD$D\n#80%\n\ndata_mask$I_.8<- output_SEIIRD$I\ndata_mask$D_.8<- output_SEIIRD$D\n\n# save data as csv\nwrite.csv(data_mask,\"FaceMask.csv\")\n\n#PLOT\n\n\n\n\n\n\n\n#PLOT infectious cases for each face mask coverage\nplot(data_mask$time,data_mask$I,\n     ylim = c(0,5e+05),\n     type=\"n\",\n     xlab='Time in days',\n     ylab = 'Number of infcetions', main=\"Infectious cases\",\n     panel.first= grid())\n\nlines(data_mask$time,data_mask$I,lwd=3,col='red')\nlines(data_mask$time,data_mask$I_.25,lwd=3,col='darkorange2')\nlines(data_mask$time,data_mask$I_.5,lwd=3,col=\"pink\")\nlines(data_mask$time,data_mask$I_.6,lwd=3,col=\"magenta\")\nlines(data_mask$time,data_mask$I_.7,lwd=3,col=\"blue\")\nlines(data_mask$time,data_mask$I_.8,lwd=3,col=\"darkgreen\")\n\nlegend('topright',c(\"0%\",\"25%\",\"50%\",\"60%\",\"70%\",\"80%\"),\n       title = \"Facemask coverage\",\n       lty=c(1,1,1,1,1,1),lwd=c(3,3,3,3,3,3),\n       col=c(\"red\",\"darkorange2\",'pink',\"magenta\",\"blue\",\"darkgreen\"))\n\n\n\n#PLOT death for each face mask coverage\nplot(data_mask$time,data_mask$D,\n     ylim = c(0,3e+05),\n     type=\"n\",\n     xlab='Time in days',\n     ylab = 'Number of infcetions', main=\"Death\",\n     panel.first= grid())\n\nlines(data_mask$time,data_mask$D,lwd=3,col='red')\nlines(data_mask$time,data_mask$D_.25,lwd=3,col='darkorange2')\nlines(data_mask$time,data_mask$D_.5,lwd=3,col=\"pink\")\nlines(data_mask$time,data_mask$D_.6,lwd=3,col=\"magenta\")\nlines(data_mask$time,data_mask$D_.7,lwd=3,col=\"blue\")\nlines(data_mask$time,data_mask$D_.8,lwd=3,col=\"darkgreen\")\n\nlegend('topleft',c(\"0%\",\"25%\",\"50%\",\"60%\",\"70%\",\"80%\"),\n       title = \"Facemask coverage\",\n       lty=c(1,1,1,1,1,1),lwd=c(3,3,3,3,3,3),\n       col=c(\"red\",\"darkorange2\",'pink',\"magenta\",\"blue\",\"darkgreen\"))\n\n\n\n\n\n\n\n\n\n",
    "created" : 1591429385770.000,
    "dirty" : false,
    "encoding" : "WINDOWS-1252",
    "folds" : "",
    "hash" : "4087808227",
    "id" : "63387BEA",
    "lastKnownWriteTime" : 1591509689,
    "last_content_update" : 1591509689082,
    "path" : "~/R-course/COVID19/Model from EPHI/ABREN/EPHI_model/SEII_hRD model_for_MaskCoverage.r",
    "project_path" : "SEII_hRD model_for_MaskCoverage.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}