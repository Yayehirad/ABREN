{
    "collab_server" : "",
    "contents" : "#SEI_pI_cI_sI_hI_icuRD model for Covid for isolation from Presympthomatic infectious by contact tracing and Testing\n#Step 1 load packages\nlibrary(deSolve)\n\n#define function\nSEI_pI_cI_sI_hI_icuRD<- function(current_timepoint, state_values, parameters)\n{\n  \n  #creat state variables (local variables)\n  S<-state_values[1] # Susceptible \n  E<-state_values[2] # Exposed\n  I_p<-state_values[3]#preclinical infectious\n  I_s<-state_values[4] #Sub-clinical infectious\n  I_c<-state_values[5] #  Clinical infectious\n  I_h<-state_values[6] # isolated infectious\n  I_icu<-state_values[7] #ICU infectious\n  R<-state_values[8] # Recovered \n  D<-state_values[9]#Died\n  with(\n    as.list(parameters), #variable names within parameters can be used\n    {\n      #compute derivative\n      \n      dS <- -beta_intervention*S*(I_c+eta_ip*I_p+eta_is*I_s+eta_ih*I_h+eta_icu*I_icu)/N\n      \n      dE <- beta_intervention*S*(I_c+eta_ip*I_p+eta_is*I_s+eta_ih*I_h+eta_icu*I_icu)/N- epsilon*E \n      \n      dI_p<- epsilon*E - alpha_ip*I_p - sigma_ic*I_p - sigma_is*I_p\n      \n      dI_s<- sigma_is*I_p - alpha_is*I_s - gamma_is*I_s\n      \n      dI_c <- sigma_ic*I_p - gamma_ic*I_c - delta_ic*I_c - phi_ic*I_c \n      \n      dI_h <- alpha_ip*I_p + phi_ic*I_c +alpha_is*I_s - gamma_ih*I_h - nu_h*I_h\n      \n      dI_icu<-  nu_h*I_h - gamma_icu*I_icu - delta_icu*I_icu\n      \n      dR <- gamma_ic*I_c + gamma_ih*I_h + gamma_icu*I_icu +gamma_is*I_s\n      \n      dD<- delta_ic*I_c + delta_ih*I_h + delta_icu*I_icu\n      \n      \n      \n      #combine results\n      results=c(dS,dE,dI_p,dI_c,dI_s,dI_h,dI_icu, dR,dD)\n      list(results)\n    }\n  )\n}\n\n\n\n\n#compartment durations\n\nincubation_period=3 \npreclinical_infectious_period=3\ninfectious_period=7 \nisolation_stay= 10\nICU_stay=20\n\n# total outflows from compartments\nE_outflow = 1/incubation_period\nI_p_outflow =1/preclinical_infectious_period\nI_c_outflow = 1/infectious_period\nI_h_outflow=1/isolation_stay\nI_s_outflow=1/infectious_period\nI_icu_outflow=1/ICU_stay\n#force of infection\nR0=2.21 #95% CI 1.35-3.3\neffective_contact_rate_per_infectious_per_time= R0/infectious_period #\n\n\nbeta = effective_contact_rate_per_infectious_per_time\n###\nproportion_Subclinical_cases=0.0\n\n\n#INTERVENTIONS\n\n##Face Mask\nC_M=0.0 #faceMask coverrage\nE_M=0.3#faceMask efficacy\n##Social distancing \nS_D=1 # relative reduction in contact rate by social distancing\n\nbeta_intervention =beta*S_D*(1-C_M*E_M)\n#\n\n\n## contact tracing and case finding\nproportion_I_p_isolated=0.0 #contact tracing and testing of presymptomatic infectious group\nproportion_I_c_isolated=0.0 #Case finding of Infectious group\nproportion_I_s_isolated=0.0 #Testing to find Subclinical cases\n\n\n\nrelative_infectiousness_of_Preclinical_compared_to_non_isolated_Clinical=0.5\nrelative_infectiousness_of_Subclinical_compared_to_non_isolated_Clinical=0.5\nrelative_infectiousness_of_Isolated_compared_to_non_isolated_Clinical=0.0\nrelative_infectiousness_of_ICU_compared_to_non_isolated_Clinical=0.5\n\neta_ip = relative_infectiousness_of_presympthomatic_compared_to_non_isolated_infectious\neta_is = relative_infectiousness_of_Subclinical_compared_to_non_isolated_Clinical\neta_ih = relative_infectiousness_of_isolated_compared_to_non_isolated_infectious\neta_icu = relative_infectiousness_of_ICU_compared_to_non_isolated_Clinical\n\nalpha_ip = proportion_I_p_isolated*I_p_outflow \nalpha_is = proportion_I_s_isolated*I_s_outflow \n\nphi_ic= proportion_I_c_isolated*I_c_outflow\n\n#progression\nepsilon=E_outflow\n\nsigma_is = proportion_Subclinical_cases*(I_p_outflow-alpha_ip)\nsigma_ic= I_p_outflow - sigma_is\n\n# proportion of critical cases, ICU\nproportion_I_h_requiring_ICU=0.08\n\nnu_ih=proportion_I_h_requiring_ICU*I_h_outflow\n\n\n#mortality\nproportion_mortality_from_I=0.05\n\nproportion_mortality_from_I_icu=0.5\n\n\ndelta_ic= proportion_mortality_from_I*(I_c_outflow-phi_ic)\n\ndelta_icu =proportion_mortality_from_I_icu*I_icu_outflow\n\n#Recovery rate\n\ngamma_ic = I_c_outflow - delta_ic - phi_ic\n\ngamma_ih =I_h_outflow - nu_ih\n\ngamma_is= I_s_outflow - alpha_is\n\ngamma_icu=I_icu_outflow - delta_icu\n\n#list parameters\n\nparameter_list<- c(beta_intervention=beta_intervention, \n                   eta_ih=eta_ih,eta_ip=eta_ip,eta_is=eta_is,\n                   \n                   sigma_ic=sigma_ic,sigma_is=sigma_is, \n                   alpha_is=alpha_is, alpha_ip=alpha_ip,\n                   phi_ic=phi_ic,\n                   \n                   delta_ic=delta_ic,delta_icu=delta_icu,\n                   \n                   gamma_ic=gamma_ic, gamma_ih=gamma_ih,gamma_icu=gamma_icu,gamma_is=gamma_is\n                   \n                        )\n#compartment population \nN=4e+06\nE0= N*0.0 #4000\nI_p0=N*0\nI_c0=N*0.00025 #1000\nI_s0=N*0\nI_h0=N*0\nI_icu0=N*0\nR0=N*0 #200\nD0=N*0\nS0= N-(E0+I_p0+I_c0+I_s0+I_h0+I_icu0+R0+D0)\n\ninitial_values <- c(S=S0,E=E0,\n                    I_c=I_c0,I_p=I_p0,I_s=I_s0,I_h=I_h0,I_icu=I_icu0,\n                    R=R0, D=D0)\ntimes=seq(0, 365, by = 1)\n\noutput=as.data.frame(lsoda(initial_values, times, SEI_pI_cI_sI_hI_icuRD, parameter_list))\nView(output)\n\n#Check total population N=4e+06\noutput$N_t<- output$S + output$E + output$I_p+ output$I_c + output$I_s+\n  output$I_h+ output$I_icu + output$R +output$D \n#View dataframe\nView(output)\n#plot population and check it is Constant\nplot(output$time,output$N_t,type = 'l')\n\n#save data \nwrite.csv(output_SEI_pII_hRD,\"SEI_pII_hRD_model.csv\")\n\n#PLOT\n\nplot(output_SEI_pII_hRD$time,output_SEI_pII_hRD$R,\n     ylim = c(0,4e+06),\n     type=\"n\",\n     xlab='Time in days',\n     ylab = 'Number of cases', main=\"Types of cases\", panel.first= grid())\n\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$S,lwd=2.5,col='blue')\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$E,lwd=2.5,col='darkorchid1')\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$I-p,lwd=2.5,col='darksalmon')\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$I,lwd=3,col=\"red\")\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$I_h,lwd=3,col=\"orange\")\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$R,lwd=2.5,col = 'green')\nlines(output_SEI_pII_hRD$time,output_SEI_pII_hRD$D,lwd=2.5,col = 'black')\nlegend('topright',c(\"Susceptible\",\"Exposed\",\"Pre-symptomatic\",\n                    \"Infectious\",\"Isolated infectious\",\n                    \"Recoverd\",\"Dead\"),\n       lty=c(1,1,1,1,1,1),lwd=c(3,3,3,3,3,3),\n       col=c(\"blue\",'darkorchid1','darksalmon',\"red\",\"orange\",\"green\",\"black\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1591620608855.000,
    "dirty" : false,
    "encoding" : "WINDOWS-1252",
    "folds" : "",
    "hash" : "824638928",
    "id" : "FF102C98",
    "lastKnownWriteTime" : 1591666286,
    "last_content_update" : 1591666286159,
    "path" : "~/R-course/COVID19/Model from EPHI/ABREN/EPHI_model/SEI_pI_cI_sI_hI_icuRD.r",
    "project_path" : "SEI_pI_cI_sI_hI_icuRD.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}